<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chai Vision Sales Dashboard - Full Channel Management</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Real-time sales performance tracking across all channels with KPI monitoring and data visualization">
    <meta name="keywords" content="sales dashboard, KPI tracking, business analytics, channel management">
    <meta name="author" content="Chai Vision">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Chai Vision Sales Dashboard">
    <meta property="og:description" content="Real-time sales performance tracking across all channels">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-domain.com">
    <meta property="og:image" content="https://your-domain.com/preview.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="public/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="public/apple-touch-icon.png">
    
    <!-- Fallback emoji favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â˜•</text></svg>">
    
    <!-- External Libraries (CDN) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="src/styles/components/navigation.css">
    <link rel="stylesheet" href="src/styles/components/sidebar.css">
    <link rel="stylesheet" href="src/styles/components/dashboard.css">
    <link rel="stylesheet" href="src/styles/components/charts.css">
    <link rel="stylesheet" href="src/styles/components/upload.css">
    <link rel="stylesheet" href="src/styles/components/settings.css">
    <link rel="stylesheet" href="src/styles/components/kpi-cards.css">
    <link rel="stylesheet" href="src/styles/components/channel-cards.css">
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loading" class="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Chai Vision Dashboard...</div>
    </div>
    
    <!-- Main App Container -->
    <div id="root"></div>
    
    <!-- No Script Warning -->
    <noscript>
        <div class="noscript-warning">
            <h2>JavaScript Required</h2>
            <p>Please enable JavaScript in your browser to use the Chai Vision Dashboard.</p>
        </div>
    </noscript>
    
    <!-- 
    ================================================================
    IMPORTANT: MODULE LOADING APPROACH
    ================================================================
    Since we're using CDN libraries (React, Chart.js, etc.) alongside 
    ES6 modules, we need a hybrid approach. The modular files need to
    be bundled or we need to use a different loading strategy.
    
    For immediate deployment without a build step, we'll use an 
    inline script that loads everything properly.
    ================================================================
    -->
    
    <!-- Load all modules as regular scripts first -->
    <script src="src/data/initialData.js"></script>
    <script src="src/js/utils/formatters.js"></script>
    <script src="src/js/utils/dateUtils.js"></script>
    <script src="src/js/utils/validators.js"></script>
    <script src="src/js/services/dataService.js"></script>
    <script src="src/js/services/supabaseService.js"></script>
    <script src="src/js/components/KPICards.js"></script>
    <script src="src/js/components/ChannelPerformance.js"></script>
    <script src="src/js/components/Charts.js"></script>
    <script src="src/js/components/Dashboard.js"></script>
    <script src="src/js/components/Settings.js"></script>
    <script src="src/js/components/Upload.js"></script>
    <script src="src/js/components/Navigation.js"></script>
    <script src="src/js/components/Sidebar.js"></script>
    <script src="src/js/config.js"></script>
    <script src="src/js/app.js"></script>
    
    <!-- Initialize Application -->
    <script>
        // Wait for all scripts and DOM to be ready
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸš€ Initializing Chai Vision Dashboard...');
            
            // Check if all required globals are loaded
            if (typeof React === 'undefined') {
                console.error('React is not loaded!');
                return;
            }
            if (typeof ReactDOM === 'undefined') {
                console.error('ReactDOM is not loaded!');
                return;
            }
            if (typeof Chart === 'undefined') {
                console.error('Chart.js is not loaded!');
                return;
            }
            if (typeof Papa === 'undefined') {
                console.error('PapaParse is not loaded!');
                return;
            }
            if (typeof XLSX === 'undefined') {
                console.error('XLSX is not loaded!');
                return;
            }
            
            // Hide loading spinner
            setTimeout(() => {
                const loadingEl = document.getElementById('loading');
                if (loadingEl) {
                    loadingEl.style.display = 'none';
                }
            }, 500);
            
            // Check if the app module loaded properly
            if (typeof window.ChaiVision !== 'undefined' && typeof window.ChaiVision.initializeApp === 'function') {
                // Initialize the application using the global namespace
                window.ChaiVision.initializeApp();
            } else {
                console.error('Application modules did not load properly. Falling back to inline initialization...');
                
                // Fallback: Initialize inline if modules didn't load
                initializeAppInline();
            }
        });
        
        // Error boundary for production
        window.addEventListener('error', (event) => {
            console.error('Application error:', event.error);
            // You could send this to an error tracking service
        });
        
        // Fallback inline initialization
        function initializeAppInline() {
            const { useState, useEffect, useMemo, useRef, createElement: h } = React;
            
            // If modules didn't load, we'll create a minimal app
            function App() {
                const [loading, setLoading] = useState(false);
                const [error, setError] = useState(null);
                
                useEffect(() => {
                    console.log('App mounted - modules may need to be configured');
                }, []);
                
                if (error) {
                    return h('div', { 
                        style: { 
                            padding: '40px', 
                            textAlign: 'center',
                            fontFamily: 'sans-serif'
                        } 
                    },
                        h('h2', { style: { color: '#ef4444' } }, 'Error Loading Dashboard'),
                        h('p', null, 'Please ensure all JavaScript files are in the correct locations.'),
                        h('p', null, 'Check the browser console for specific errors.'),
                        h('button', {
                            onClick: () => window.location.reload(),
                            style: {
                                padding: '10px 20px',
                                background: '#667eea',
                                color: 'white',
                                border: 'none',
                                borderRadius: '8px',
                                cursor: 'pointer',
                                marginTop: '20px'
                            }
                        }, 'Reload Page')
                    );
                }
                
                return h('div', { 
                    style: { 
                        padding: '40px', 
                        textAlign: 'center',
                        fontFamily: 'sans-serif'
                    } 
                },
                    h('h1', { 
                        style: { 
                            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                            WebkitBackgroundClip: 'text',
                            WebkitTextFillColor: 'transparent',
                            backgroundClip: 'text'
                        } 
                    }, 'Chai Vision Dashboard'),
                    h('p', null, 'Dashboard is initializing...'),
                    h('p', { style: { color: '#6b7280', marginTop: '20px' } }, 
                        'If the dashboard doesn\'t load, please check that all files are in the correct locations.'
                    )
                );
            }
            
            // Render the fallback app
            ReactDOM.render(React.createElement(App), document.getElementById('root'));
        }
    </script>
    
    <!-- 
    ================================================================
    ALTERNATIVE: ES6 Module Approach (Recommended for modern setups)
    ================================================================
    If you want to use ES6 modules properly, you'll need to:
    
    1. Update all your JS files to properly export/import
    2. Use a local development server (not file://)
    3. Uncomment the script below and remove the regular script tags above
    
    <script type="module">
        import { CONFIG } from './src/js/config.js';
        import { initializeApp } from './src/js/app.js';
        
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ðŸš€ Initializing Chai Vision Dashboard...');
            
            setTimeout(() => {
                const loadingEl = document.getElementById('loading');
                if (loadingEl) {
                    loadingEl.style.display = 'none';
                }
            }, 500);
            
            initializeApp(CONFIG);
        });
    </script>
    ================================================================
    -->
</body>
</html>
